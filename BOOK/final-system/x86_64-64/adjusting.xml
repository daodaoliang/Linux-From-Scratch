<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
  "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>

<sect1 id="ch-system-adjusting">
  <?dbhtml filename="adjusting.html"?>

  <title>Adjusting the Toolchain</title>

  <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
  href="../x86/adjusting.xml"
  xpointer="xpointer(//*[@os='a'])"/>

  <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
  href="../x86/adjusting.xml"
  xpointer="xpointer(//*[@os='b'])"/>

  <para>First we will adjust the 32 bit ABI:</para>

<screen><userinput>perl -pi -e 's@ /tools/lib32/ld-linux.so.2@ /lib32/ld-linux.so.2@g;' \
    -e 's@\*startfile_prefix_spec:\n@$_/usr/lib32/ @g;' \
        `gcc --print-file specs`</userinput></screen>

  <para>Second we will adjust the 64 bit ABI:</para>

<screen><userinput>perl -pi -e 's@ /tools/lib/ld-linux-x86-64.so.2@ /lib/ld-linux-x86-64.so.2@g;' \
    -e 's@\*startfile_prefix_spec:\n@$_/usr/lib/ @g;' \
        `gcc --print-file specs`</userinput></screen>

  <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
  href="../x86/adjusting.xml"
  xpointer="xpointer(//*[@os='d'])"/>

  <para>Note that <filename class="directory">/lib</filename> or
  <filename class="directory">/lib32</filename> is now the prefix
  of our dynamic linker.</para>

  <caution>

    <para>It is imperative at this point to stop and ensure that
    the basic functions (compiling and linking) of the adjusted toolchain
    are working as expected. Since we are doing a 64 bit only build, we
    will only test the 64 bit ABI. To do this, perform a sanity
    check:</para>

    <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
    href="../x86/adjusting.xml"
    xpointer="xpointer(//*[@os='g'])"/>

    <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
    href="../x86/adjusting.xml"
    xpointer="xpointer(//*[@os='h'])"/>

<screen><computeroutput>[Requesting program interpreter: /lib/ld-linux-x86-64.so.2]</computeroutput></screen>

    <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
    href="../x86/adjusting.xml"
    xpointer="xpointer(//*[@os='j'])"/>

    <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
    href="../x86/adjusting.xml"
    xpointer="xpointer(//*[@os='k'])"/>

    <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
    href="../x86/adjusting.xml"
    xpointer="xpointer(//*[@os='l'])"/>

    <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
    href="../x86/adjusting.xml"
    xpointer="xpointer(//*[@os='m'])"/>

  </caution>

</sect1>
