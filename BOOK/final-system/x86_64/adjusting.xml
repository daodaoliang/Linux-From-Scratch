<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
  "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>

<sect1 id="ch-system-adjusting">
  <?dbhtml filename="adjusting.html"?>

  <title>Adjusting the Toolchain</title>

  <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
  href="../x86/adjusting.xml"
  xpointer="xpointer(//*[@os='a'])"/>

  <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
  href="../x86/adjusting.xml"
  xpointer="xpointer(//*[@os='b'])"/>

  <para>First we will adjust the 32 bit ABI:</para>

  <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
  href="../x86/adjusting.xml"
  xpointer="xpointer(//*[@os='c'])"/>

  <para>Second we will adjust the 64 bit ABI:</para>

<screen><userinput>perl -pi -e 's@ /tools/lib64/ld-linux-x86-64.so.2@ /lib64/ld-linux-x86-64.so.2@g;' \
    -e 's@\*startfile_prefix_spec:\n@$_/usr/lib64/ @g;' \
        `gcc --print-file specs`</userinput></screen>

  <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
  href="../x86/adjusting.xml"
  xpointer="xpointer(//*[@os='d'])"/>

  <para>Note that <filename class="directory">/lib</filename> or
  <filename class="directory">/lib64</filename> is now the prefix
  of our dynamic linker.</para>

  <caution>

    <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
    href="../x86/adjusting.xml"
    xpointer="xpointer(//*[@os='f'])"/>

    <para>For 32 bit ABI:</para>

<screen><userinput>echo 'main(){}' &gt; dummy.c
cc ${BUILD32} dummy.c
readelf -l a.out | grep ': /lib'</userinput></screen>

    <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
    href="../x86/adjusting.xml"
    xpointer="xpointer(//*[@os='h'])"/>

    <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
    href="../x86/adjusting.xml"
    xpointer="xpointer(//*[@os='i'])"/>

    <para>For 64 bit ABI:</para>

<screen><userinput>echo 'main(){}' &gt; dummy.c
cc ${BUILD64} dummy.c
readelf -l a.out | grep ': /lib'</userinput></screen>

    <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
    href="../x86/adjusting.xml"
    xpointer="xpointer(//*[@os='h'])"/>

<screen><computeroutput>[Requesting program interpreter: /lib64/ld-linux-x86-64.so.2]</computeroutput></screen>

    <para>Note that <filename class="directory">/lib</filename> or
    <filename class="directory">/lib64</filename> is now the prefix
    of our dynamic linker.</para>

    <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
    href="../x86/adjusting.xml"
    xpointer="xpointer(//*[@os='k'])"/>

    <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
    href="../x86/adjusting.xml"
    xpointer="xpointer(//*[@os='l'])"/>

    <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
    href="../x86/adjusting.xml"
    xpointer="xpointer(//*[@os='m'])"/>

  </caution>

</sect1>
