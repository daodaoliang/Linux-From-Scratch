<qandaentry id="undefined-deflate">
<question><para>undefined reference to `deflate'</para></question>
<answer><para>If, when compiling XFree86, ghostscript,
or anything else that uses libpng,
you get an error including the following line:
<screen>/usr/lib/gcc-lib/i686-pc-linux-gnu/3.2/../../../libpng.so: undefined reference
to `deflate'
</screen>
Then rebuild libpng with the patch at
<ulink url="http://www.linuxfromscratch.org/~sklein/libpng-1.2.5-lz.patch"/>.
Make sure you apply the patch immediately after unpacking the sources.
Like this:
<screen>tar --no-same-owner -xvjf libpng-1.2.5.tar.bz2
cd libpng-1.2.5
cat ../libpng-1.2.5-lz.patch | patch -p0
ln -s scripts/makefile.linux Makefile
make ZLIBLIB=/lib ZLIBINC=/usr/include
make ZLIBLIB=/lib ZLIBINC=/usr/include install
cd ..
rm -r libpng-1.2.5
</screen>
Needless to say, if you originally put zlib in /usr/local
or did something else different,
you'll have to adjust those instructions accordingly.
</para></answer>
</qandaentry>
