<sect2><title>&nbsp;</title><para>&nbsp;</para></sect2>

<sect2>
<title>Installation of GCC</title>

<para>This package is known to behave badly when you have changed its
default optimization flags (including the -march and -mcpu options).
Therefore, if you have defined any environment variables that override
default optimizations, such as CFLAGS and CXXFLAGS, we recommend unsetting
or modifying them when building GCC.</para>

<para>We will be building the C and C++ compilers at this time, so you'll
need to unpack both the gcc-core and gcc-g++ tarballs. Other compilers are
available in the full gcc package; instructions for building them may be
found at <ulink url="&blfs-root;view/cvs/general/gcc.html"/>.</para>

<para><screen><userinput>patch -Np1 -i ../gcc-&gcc-version;-no_fixincludes.patch
patch -Np1 -i ../gcc-&gcc-version;-mmap_test.patch</userinput></screen></para>

<para>It is recommended by the GCC installation documentation to build GCC
in a dedicated directory outside of the source tree. Create the build
directory:</para>

<para><screen><userinput>mkdir ../gcc-build &amp;&amp;
cd ../gcc-build</userinput></screen></para>

<para>Prepare GCC to be compiled:</para>

<para><screen><userinput>CFLAGS="-O2 -pipe" CXXFLAGS="-O2 -pipe" \
&nbsp;&nbsp;&nbsp;&nbsp;../gcc-&gcc-version;/configure --prefix=/usr \
&nbsp;&nbsp;&nbsp;&nbsp;--enable-shared --enable-threads=posix \
&nbsp;&nbsp;&nbsp;&nbsp;--enable-__cxa_atexit --enable-clocale=gnu \
&nbsp;&nbsp;&nbsp;&nbsp;--mandir=/usr/share/man \
&nbsp;&nbsp;&nbsp;&nbsp;--infodir=/usr/share/info</userinput></screen></para>

<para>The meanings of the configure options are:</para>

<itemizedlist>
<listitem><para><userinput>--enable-threads=posix</userinput>: This enables
C++ exception handling for multi-threaded code.</para></listitem>

<listitem><para><userinput>--enable-__cxa_atexit</userinput>: This option
will result in C++ shared libraries and C++ programs that are interoperable
with other Linux distributions.</para></listitem>

<listitem><para><userinput>--enable-clocale=gnu</userinput>: There is a risk
that some people will build ABI incompatible C++ libraries if they didn't
install all of the glibc localedata. Using --enable-clocale=gnu ensures that
the "right thing" is done in all cases. If you don't wish to use this option,
then at least build the <emphasis>de_DE</emphasis> locale. When GCC finds
this specific locale, then the correct locale mode (<emphasis>gnu</emphasis>)
is implemented.</para></listitem>
</itemizedlist>

<para>Continue with compiling the package:</para>

<para><screen><userinput>make LDFLAGS="-s"</userinput></screen></para>

<para><screen><userinput>make -k check</userinput></screen></para>

<para>Finish installing the package:</para>

<para><screen><userinput>make install</userinput></screen></para>

<para>Some packages expect the C PreProcessor to be installed in the
<filename>/lib</filename> and <filename>/usr/lib</filename> directories.
To honor those packages, create two symlinks:</para>

<para><screen><userinput>ln -s ../usr/bin/cpp /lib</userinput></screen></para>

<para>Many packages compile using <emphasis>cc</emphasis> as the name for
the C compiler. To satisfy those packages, create a <emphasis>cc</emphasis>
symlink:</para>

<para><screen><userinput>ln -s gcc /usr/bin/cc</userinput></screen></para>

<para><screen><userinput>rm /usr/lib/libiberty.a</userinput></screen></para>

</sect2>
