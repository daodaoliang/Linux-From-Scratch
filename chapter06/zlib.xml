<sect1 id="ch06-zlib" xreflabel="Zlib">
<title>Installing Zlib-&zlib-version;</title>
<?dbhtml filename="zlib.html" dir="chapter06"?>

<para>The Zlib package contains compression and uncompression routines used by
some programs.</para>

<screen>&buildtime; &zlib-time;
&diskspace; &zlib-compsize;</screen>

&aa-zlib-down;
&aa-zlib-dep;

<sect2><title>&nbsp;</title><para>&nbsp;</para></sect2>

<sect2>
<title>Installation of Zlib</title>

<para>Prepare Zlib for compilation:</para>

<screen><userinput>./configure --prefix=/usr --shared</userinput></screen>

<note><para>Zlib is known to build its shared library incorrectly if CFLAGS is
specified in the environment. If you are using your own CFLAGS variable, be
sure to add the <emphasis role="strong">-fPIC</emphasis> directive to your
CFLAGS for the duration of the above command, then remove it
afterwards.</para></note>

<para>Compile the package:</para>

<screen><userinput>make</userinput></screen>

<para>This package has a test suite available which can perform a number of
checks to ensure it built correctly. The test suite for Zlib is quick and
painless so we recommend it be run. The following command will test the shared
library:</para>

<screen><userinput>make check</userinput></screen>

<para>Install the shared library:</para>

<screen><userinput>make install</userinput></screen>

<para>Now also build the non-shared (static) library:</para>
<screen><userinput>make clean
./configure --prefix=/usr
make</userinput></screen>

<para>The following command will test the static library:</para>

<screen><userinput>make check</userinput></screen>

<para>Install the static library:</para>

<screen><userinput>make install</userinput></screen>

<para>And fix the permissions on the static library:</para>

<screen><userinput>chmod 644 /usr/lib/libz.a</userinput></screen>

<para>It is good policy and common practice to place important libraries into
the <filename class="directory">/lib</filename> directory. This matters most
in scenarios where <filename class="directory">/usr</filename> is on a
separate partition. Essentially, the run-time components of any libraries
depended upon by programs in <filename class="directory">/bin</filename> or
<filename class="directory">/sbin</filename> should reside in
<filename class="directory">/lib</filename> so that they are on the root
partition and available in the event of
<filename class="directory">/usr</filename> being inaccessible.</para>

<para>Therefore we move the run-time components of the shared Zlib into
<filename class="directory">/lib</filename> by issuing the following
command:</para>

<screen><userinput>mv /usr/lib/libz.so.* /lib</userinput></screen>

<para>Now we need to fix up the <filename>/usr/lib/libz.so</filename> symlink
because we just moved the location of the file it points to:</para>

<screen><userinput>ln -sf ../../lib/libz.so.1 /usr/lib/libz.so</userinput></screen>

</sect2>

&aa-zlib-shortdesc;
&aa-zlib-desc;

</sect1>

