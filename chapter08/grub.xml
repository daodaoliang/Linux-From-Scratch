<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>
<sect1 id="ch-bootable-grub">
<title>Making the LFS System Bootable</title>
<?dbhtml filename="grub.html"?>


<para>We highly recommend that you create a Grub boot floppy diskette just in case.
Insert a blank floppy diskette and run the following commands:</para>

<screen><userinput>dd if=/boot/grub/stage1 of=/dev/fd0 bs=512 count=1
dd if=/boot/grub/stage2 of=/dev/fd0 bs=512 seek=1</userinput></screen>

<para>Remove the diskette and store it somewhere safe. Now we'll run the
<command>grub</command> shell:</para>

<screen><userinput>grub</userinput></screen>

<para>First, tell Grub where to search for its <filename>stage{1,2}</filename>
files -- you can use the Tab key everywhere to make Grub show the alternatives:</para>

<screen><userinput>root (hd0,3)</userinput></screen>

<para>Tell Grub to install itself into the MBR (Master Boot Record) of
<filename class="partition">hda</filename>:</para>

<screen><userinput>setup (hd0)</userinput></screen>

<para>If all is well, Grub will have reported finding its files in
<filename class="directory">/boot/grub</filename>. That's all there is to it:</para>

<screen><userinput>quit</userinput></screen>

<para>Now we need to create a <quote>menu list</quote> file, defining Grub's
boot menu:</para>

<screen><userinput>cat &gt; /boot/grub/menu.lst &lt;&lt; "EOF"
<literal># Begin /boot/grub/menu.lst

# By default boot the first menu entry.
default 0

# Allow 30 seconds before booting the default.
timeout 30

# Use prettier colors.
color green/black light-green/black

# The first entry is for LFS.
title LFS &version;
root (hd0,3)
kernel /boot/lfskernel-&linux-version; root=/dev/hda4</literal>
EOF</userinput></screen>

<para>You may want to add an entry for your host distribution. It might look
like this:</para>

<screen><userinput>cat &gt;&gt; /boot/grub/menu.lst &lt;&lt; "EOF"
<literal>title Red Hat
root (hd0,2)
kernel /boot/kernel-2.4.20 root=/dev/hda3
initrd /boot/initrd-2.4.20</literal>
EOF</userinput></screen>

<para>Also, if you happen to dual-boot Windows, the following entry should
allow booting it:</para>

<screen><userinput>cat &gt;&gt; /boot/grub/menu.lst &lt;&lt; "EOF"
<literal>title Windows
rootnoverify (hd0,0)
chainloader +1</literal>
EOF</userinput></screen>

<para>The FHS stipulates that Grub's menu.lst file should be symlinked to
/etc/grub/menu.lst.  To satisfy this requirement, issue the following
command:</para>

<screen><userinput>mkdir /etc/grub &amp;&amp;
ln -s /boot/grub/menu.lst /etc/grub</userinput></screen>

</sect1>
