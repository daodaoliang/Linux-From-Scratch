<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>
<sect1 xmlns:xi="http://www.w3.org/2003/XInclude" id="ch-scripts-network">
<title>Configuring the network script</title>
<?dbhtml filename="network.html"?>

<indexterm zone="ch-scripts-network">
<primary sortas="d-network">network</primary>
<secondary>configuring</secondary></indexterm>

<para>This section only applies if you're going to configure a network
card.</para>

<para>If you don't have any network cards, you are most likely not going to
create any configuration files relating to network cards. If that is the
case, you must remove the <filename>network</filename> symlinks from all the
run-level directories
(<filename class="directory">/etc/rc.d/rc*.d</filename>)</para>

<sect2>
<title>Configuring default gateway</title>

<para>If you're on a network you may need to set up the default gateway (a node on your network that provides access to other networks) for
this machine. This is done by adding the proper values to the
/etc/sysconfig/network file by running the following:</para>

<screen><userinput>cat &gt;&gt; /etc/sysconfig/network &lt;&lt; "EOF"</userinput>
GATEWAY=192.168.1.2
GATEWAY_IF=eth0
<userinput>EOF</userinput></screen>

<para>The values for GATEWAY and GATEWAY_IF need to be changed to match
your network setup. GATEWAY contains the IP address of the default
gateway, and GATEWAY_IF contains the network interface through which the
default gateway can be reached.</para>

</sect2>

<sect2>
<title>Creating network interface configuration files</title>

<para>Which interfaces are brought up and down by the network script depends on
the files in the /etc/sysconfig/network-devices directory. This
directory should contain files in the form of ifconfig.xyz, where xyz is a
network interface name (such as eth0 or eth0:1)</para>

<para>If you decide to rename or move this /etc/sysconfig/network-devices
directory, make sure you update the /etc/sysconfig/rc file as well and
update the network_devices by providing it with the new path.</para>

<para>Now, new files are created in that directory.
The following command creates a sample ifconfig.eth0 file:</para>

<screen><userinput>cat &gt; /etc/sysconfig/network-devices/ifconfig.eth0 &lt;&lt; "EOF"</userinput>
ONBOOT=yes
SERVICE=static
IP=192.168.1.1
NETMASK=255.255.255.0
BROADCAST=192.168.1.255
<userinput>EOF</userinput></screen>

<para>Of course, the values of those variables have to be changed 
in every file to match the proper setup. If the ONBOOT variable is set
to yes, the network script will bring up the equivalent NIC (Network Interface Card)
 during the booting of the system.
If set to anything but yes, the equivalent NIC will be ignored by the network script
and not brought up.</para>

<para>The SERVICE entry defines the method of obtaining the IP address.
The LFS bootscripts have a modular IP assignment format, and by creating
additional files in /etc/sysconfig/network-devices/services, you can allow
other IP assignment methods.  This would commonly be used if you need DHCP,
which is addressed in the BLFS book.</para>

</sect2>

<sect2>
<title>Creating the /etc/resolv.conf file</title>

<para>If you're going to be connected to the Internet then most likely you'll
need some means of DNS name resolution to resolve Internet domain names to IP
addresses. This is best achieved by placing the IP address of your DNS, available from your ISP (Internet Service Provider) or network administrator,
into <filename>/etc/resolv.conf</filename>. Create the file by running the
following:</para>

<screen><userinput>cat &gt; /etc/resolv.conf &lt;&lt; "EOF"</userinput>
# Begin /etc/resolv.conf

nameserver &lt;IP address of your nameserver&gt;

# End /etc/resolv.conf
<userinput>EOF</userinput></screen>

<para>Of course, replace &lt;IP address of your nameserver&gt; with the IP
address of the DNS most appropriate for your setup. There will often be
more than one entry (requirements demand secondary servers for fallback capability). The IP address may even be a router on your local network.</para>

</sect2>

</sect1>
